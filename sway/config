# Read `man 5 sway` for a complete reference.
font pango:Input Nonicons,monospace 16px

##
# COLORS
##
# set next split direction indicator to be the same color as the border

#              border background text indicator child_border
client.focused #4c7899 #285577 #ffffff #285577 #285577
client.focused_inactive #333333 #5f676a #ffffff #5f676a #5f676a
client.unfocused #333333 #222222 #888888 #222222 #222222
client.urgent #2f343a #900000 #ffffff #900000 #900000
client.placeholder #000000 #0c0c0c #ffffff #0c0c0c #0c0c0c


##
# VARIABLES
##

# Logo key. Use Mod1 for Alt.
set $mod Mod1
set $win Mod4

# Home row direction keys, like vim
set $left h
set $down j
set $up k
set $right l

# Your preferred terminal emulator
set $term alacritty
set $browser brave-browser

# Styles
set $highlight #ffb083

# Your preferred application launcher
set $menu fuzzel

# Wallpaper
set $wallpaper $HOME/Pictures/wallpaper.jpg
set $default_light 15

# Notifications
set $notify exec dunstify -a sway -r 2001

# Progress bars
set $WOBSOCK $XDG_RUNTIME_DIR/wob.sock
exec rm -f $WOBSOCK && mkfifo $WOBSOCK && tail -f $WOBSOCK | wob


##
# Options
##

default_border pixel 2
default_floating_border normal
hide_edge_borders smart

floating_modifier $mod

##
# Output configuration
##

# output * bg #000000 solid_color
output * bg $wallpaper fill

output eDP-1 {
    mode 2880x1800@90.001Hz
    scale 1
}

##
# Idle configuration
##

# This will lock your screen after 300 seconds of inactivity, then turn off
# your displays after another 300 seconds, and turn your screens back on when
# resumed. It will also lock your screen before your computer goes to sleep.
set $lock $HOME/.config/sway/lock.sh

exec swayidle -w \
      timeout 120 'light -O; $HOME/.config/sway/dim-screen.sh' \
          resume 'light -I' \
      timeout 300 '$lock' \
      timeout 30 'if pgrep -x swaylock; then light -O; swaymsg "output * dpms off"; fi' \
          resume 'if pgrep -x swaylock; then swaymsg "output * dpms on"; light -I; fi' \
      before-sleep '$lock'

bindswitch --locked lid:on exec $lock

# disable timeout when in fullscreen
for_window [class="^.*"] inhibit_idle fullscreen
for_window [app_id="^.*"] inhibit_idle fullscreen

##
# Input configuration
##

input type:touchpad {
  dwt enabled
  tap enabled
  scroll_factor 0.15
  natural_scroll enabled
  middle_emulation enabled
}

input type:keyboard {
  xkb_layout us,pl
  xkb_options caps:escape,grp:rctrl_rshift_toggle
}

##
# Key bindings
##

# Lock the screen
bindsym $win+l exec $lock

# Start a terminal
bindsym $mod+Return exec $term

# start a browser
bindsym $mod+b exec $browser

# Kill focused window
bindsym $mod+Shift+q kill

# Start your launcher
bindsym $mod+d exec $menu

# Reload the configuration file
bindsym $mod+Shift+c reload; exec dunstify -u low "  Sway config reloaded!"


# Exit sway (logs you out of your Wayland session)
bindsym --locked $mod+Shift+e exec swaynag -t warning -m "You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session." -B "Yes, exit sway" "swaymsg exit"

# Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right

# Move the focused window with the same, but add Shift
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right

# Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

# for horizontal split
bindsym $mod+z splith
# for vertical split
bindsym $mod+v splitv

# # Switch the current container between different layout styles
# # bindsym $mod+s layout stacking
# # bindsym $mod+w layout tabbed
# bindsym $mod+e layout toggle split

# Make the current focus fullscreen
bindsym $mod+f fullscreen

bindsym $mod+p exec 1password
bindsym Ctrl+Shift+l exec 1password --lock
bindsym Ctrl+Shift+space exec 1password --quick-access

# Toggle the current focus between tiling and floating mode
bindsym $mod+Shift+space floating toggle

# Swap focus between the tiling area and the floating area
bindsym $mod+space focus mode_toggle

# # Move focus to the parent container
# bindsym $mod+a focus parent

##
# FKeys
##

# Pulse Audio controls
bindsym --locked XF86AudioRaiseVolume exec pactl set-sink-volume @DEFAULT_SINK@ +5% && pactl get-sink-volume @DEFAULT_SINK@ | awk 'NR==1{print substr($5,1,length($5)-1)}' > $WOBSOCK
bindsym --locked XF86AudioLowerVolume exec pactl set-sink-volume @DEFAULT_SINK@ -5% && pactl get-sink-volume @DEFAULT_SINK@ | awk 'NR==1{print substr($5,1,length($5)-1)}' > $WOBSOCK
bindsym --locked XF86AudioMute exec pactl set-sink-mute @DEFAULT_SINK@ toggle && $notify "󰕾 $(pactl get-sink-mute @DEFAULT_SINK@)"
bindsym --locked XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle

bindsym --locked XF86AudioPlay exec playerctl play-pause && sleep 0.2 && $notify "󰲹 $(playerctl status)"
bindsym --locked XF86AudioStop exec playerctl stop && $notify "󰲹 Stopped playback"
bindsym --locked XF86AudioNext exec playerctl next
bindsym --locked XF86AudioPrev exec playerctl previous

# Sreen brightness controls
exec light -S $default_light
bindsym --locked XF86MonBrightnessUp exec light -A 5 && light | cut -d'.' -f1 > $WOBSOCK
bindsym --locked XF86MonBrightnessDown exec light -U 5 && light | cut -d'.' -f1 > $WOBSOCK

# Toggle touchpad
bindsym --locked XF86TouchpadToggle \
        input type:touchpad events toggle enabled disabled; \
        $notify "Touchpad" "$(swaymsg -t get_inputs -r | jq '.[] | select(.type==\"touchpad\") | .libinput.send_events')"

##
# Scratchpad
##

# Move the currently focused window to the scratchpad
bindsym $mod+Shift+minus move scratchpad

# Show the next scratchpad window or hide the focused scratchpad window.
bindsym $mod+minus scratchpad show

##
# Resizing containers
##

mode "resize" {
    bindsym $left resize shrink width 50px
    bindsym $down resize grow height 50px
    bindsym $up resize shrink height 50px
    bindsym $right resize grow width 50px

    bindsym Left resize shrink width 50px
    bindsym Down resize grow height 50px
    bindsym Up resize shrink height 50px
    bindsym Right resize grow width 50px

    bindsym Return mode "default"
    bindsym Escape mode "default"
    bindsym $mod+r mode "default"

    bindsym $mod+s sticky toggle
}
bindsym $mod+r mode "resize"

##
# Screenshots
##

bindsym $win+Shift+s exec $HOME/.config/sway/screenshot.sh area
bindsym Print exec $HOME/.config/sway/screenshot.sh output
bindsym Shift+Print exec $HOME/.config/sway/screenshot.sh window

##
# Status Bar
##
bar {
    status_command i3status
    separator_symbol " | "
    colors {
        statusline #e0def4
    }
}

##
# GTK
##

set $system_dpi_scaling_factor 1.25
set $cursor_size 28

exec_always {
    gsettings set org.gnome.desktop.interface color-scheme prefer-dark
    gsettings set org.gtk.Settings.FileChooser window-size '(1000, 500)'
    gsettings set org.gnome.desktop.interface cursor-size $cursor_size
    gsettings set org.gnome.desktop.interface text-scaling-factor $system_dpi_scaling_factor
    gsettings set org.gnome.mutter experimental-features "['scale-monitor-framebuffer']"
}

# Mouse
seat seat0 xcursor_theme Adwaita $cursor_size


##
# App settings
##

for_window [app_id="flameshot"] border pixel 0, floating enable, fullscreen disable, move absolute position 0 0
for_window [app_id="blueman-manager"] floating enable
for_window [class="1Password"] floating enable
for_window [app_id="firefox" title="Picture-in-Picture"] floating enable, resize set width 640 px height 360 px, move position 0 px 0 px, sticky on
for_window [title="Emulator*"] floating enable
for_window [app_id="python3"] floating enable
for_window [app_id="gnuplot_qt"] floating enable, resize set width 1000 px height 800 px
for_window [class="Xplot"] floating enable
for_window [class="Matplotlib"] floating enable, resize set width 1000 px height 800 px
for_window [class="matplotlib"] floating enable, resize set width 1000 px height 800 px
for_window [class="ROOT"] floating enable, resize set width 1000 px height 800 px
for_window [class="org-openscience-jmol-app-jmolpanel-JmolPanel"] floating enable
for_window [title="Picture in picture"] floating enable, resize set width 640 px height 360 px, move position 0 px 0 px, sticky on

for_window [title="Friends List" class="steam"] floating enable
for_window [title="Steam Settings" class="steam"] floating enable

for_window [window_role="About"] floating enable
for_window [window_role="Preferences"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="pop-up"] floating enable
for_window [window_role="task_dialog"] floating enable

# R windows
for_window [title="Data: *"] floating enable, resize set width 1000 px height 800 px
for_window [title="R Graphics: *"] floating enable, resize set width 1000 px height 800 px



##
# Startup
##

exec systemctl --user import-environment DISPLAY WAYLAND_DISPLAY SWAYSOCK XDG_CURRENT_DESKTOP
exec dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP=sway

exec /usr/libexec/xdg-desktop-portal -r &
exec /usr/libexec/polkit-gnome-authentication-agent-1 &
exec /usr/libexec/gsd-xsettings &

exec nm-applet &
exec blueman-applet &
exec dunst &
exec /usr/bin/1password --silent &
exec $HOME/.config/.scripts/autotiling &

assign [class="thunderbird"] 5

exec swaymsg 'workspace 5; exec thunderbird'
exec swaymsg 'workspace 3; exec $term'
exec swaymsg 'workspace 2; exec $browser'
